import{c,u as w,r as a,j as e,L as N,s as p}from"./index-DeG7gfPn.js";import{A}from"./alert-triangle-sA03gO4B.js";import{U as R}from"./users-CHpAZXeh.js";import{m as k}from"./proxy-DDLR_7cQ.js";import{M}from"./map-pin-ocWYqDe0.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u=c("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=c("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=c("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),q=()=>{const{session:C}=w(),[r,g]=a.useState({totalReports:0,activeAlerts:0,communityMembers:0,recentActivities:0}),[n,y]=a.useState([]),[f,d]=a.useState(!0),[o,m]=a.useState(null),x=async()=>{try{d(!0),m(null);const{data:t,error:i}=await p.from("reports").select("*");if(i)throw i;const{data:l,error:h}=await p.from("reports").select("*").order("created_at",{ascending:!1}).limit(5);if(h)throw h;const j=(l==null?void 0:l.map(s=>({id:s.id,type:s.type,location:s.location,timestamp:new Date(s.created_at).toLocaleDateString(),status:s.status})))||[];g({totalReports:(t==null?void 0:t.length)||0,activeAlerts:(t==null?void 0:t.filter(s=>s.status!=="resolved").length)||0,communityMembers:150,recentActivities:24}),y(j)}catch(t){console.error("Error fetching dashboard data:",t),m("Failed to fetch dashboard data. Please try again later.")}finally{d(!1)}};a.useEffect(()=>{x()},[]);const b=[{title:"Total Reports",value:r.totalReports,icon:A,color:"bg-blue-500"},{title:"Active Alerts",value:r.activeAlerts,icon:u,color:"bg-red-500"},{title:"Community Members",value:r.communityMembers,icon:R,color:"bg-green-500"},{title:"Recent Activities",value:r.recentActivities,icon:u,color:"bg-purple-500"}],v=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"investigating":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return f?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Welcome back! Here's an overview of disaster management activities."})]}),e.jsxs("button",{onClick:x,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),o&&e.jsx("div",{className:"mb-8 p-4 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-sm text-red-600",children:o})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:b.map((t,i)=>e.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-full ${t.color}`,children:e.jsx(t.icon,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-500",children:t.title}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:t.value})]})]})},t.title))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Reports"}),e.jsxs(N,{to:"/report",className:"text-blue-600 hover:text-blue-700 flex items-center text-sm font-medium",children:["View all reports",e.jsx(L,{className:"ml-1 h-4 w-4"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:n.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-4 w-4 text-gray-400 mr-1"}),t.location]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.timestamp}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v(t.status)}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})})]},t.id))})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No reports available"})})})]})]})};export{q as default};
