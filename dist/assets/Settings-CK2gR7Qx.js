import{c as x,u as P,r as l,j as e,S as z,d as L,s as f}from"./index-DeG7gfPn.js";import{A as q}from"./alert-triangle-sA03gO4B.js";import{U as I}from"./user-BdaVWNel.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=x("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=x("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=x("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=x("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),B=()=>{const{user:c,profile:s,refreshProfile:T}=P(),[j,v]=l.useState(!1),[N,u]=l.useState(null),[w,y]=l.useState(null),[i,_]=l.useState({email_alerts:!0,push_notifications:!0,sms_alerts:!1,disaster_radius_km:50}),[o,S]=l.useState({theme:"system",language:"en",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),[m,C]=l.useState({share_location:!0,public_profile:!1,anonymous_reports:!1}),[n,F]=l.useState({full_name:(s==null?void 0:s.full_name)||"",mobile:(s==null?void 0:s.mobile)||"",address:(s==null?void 0:s.address)||"",emergency_contact:(s==null?void 0:s.emergency_contact)||""});l.useEffect(()=>{(async()=>{var r;if(c)try{const{data:a,error:d}=await f.from("user_settings").select("*").eq("user_id",c.id).single();if(d&&!d.message.includes("no rows"))throw d;a&&(_(a.notifications||i),S(a.appearance||o),C(a.privacy||m));const k=((r=a==null?void 0:a.appearance)==null?void 0:r.theme)||"system";M(k)}catch(a){console.error("Error loading settings:",a),u("Failed to load settings. Please try again.")}})()},[c]),l.useEffect(()=>{s&&F({full_name:s.full_name||"",mobile:s.mobile||"",address:s.address||"",emergency_contact:s.emergency_contact||""})},[s]);const M=t=>{const r=window.document.documentElement,a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";(t==="system"?a:t)==="dark"?r.classList.add("dark"):r.classList.remove("dark")},E=async()=>{if(c){v(!0),u(null),y(null);try{const{error:t}=await f.from("user_settings").upsert({user_id:c.id,notifications:i,appearance:o,privacy:m,updated_at:new Date().toISOString()});if(t)throw t;const{error:r}=await f.from("profiles").update({full_name:n.full_name,mobile:n.mobile,address:n.address,emergency_contact:n.emergency_contact,updated_at:new Date().toISOString()}).eq("id",c.id);if(r)throw r;M(o.theme),await T(),y("Settings saved successfully!"),setTimeout(()=>y(null),3e3)}catch(t){console.error("Error saving settings:",t),u("Failed to save settings. Please try again.")}finally{v(!1)}}},g=t=>{const{name:r,value:a,type:d,checked:k}=t.target;_(A=>({...A,[r]:d==="checkbox"?k:Number(a)}))},b=t=>{const{name:r,value:a}=t.target;S(d=>({...d,[r]:a}))},p=t=>{const{name:r,checked:a}=t.target;C(d=>({...d,[r]:a}))},h=t=>{const{name:r,value:a}=t.target;F(d=>({...d,[r]:a}))};return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 sm:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Settings"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Manage your account preferences and application settings."})]}),N&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-5 w-5 text-red-500 dark:text-red-400 mr-2"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-400",children:N})]})}),w&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400",children:w})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Profile"})]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Full Name"}),e.jsx("input",{type:"text",id:"full_name",name:"full_name",value:n.full_name,onChange:h,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mobile",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mobile Number"}),e.jsx("input",{type:"tel",id:"mobile",name:"mobile",value:n.mobile,onChange:h,pattern:"[0-9]{10}",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Address"}),e.jsx("input",{type:"text",id:"address",name:"address",value:n.address,onChange:h,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"emergency_contact",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Emergency Contact"}),e.jsx("input",{type:"tel",id:"emergency_contact",name:"emergency_contact",value:n.emergency_contact,onChange:h,pattern:"[0-9]{10}",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"})]})]})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Notifications"})]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email_alerts",className:"font-medium text-gray-700 dark:text-gray-300",children:"Email Alerts"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Receive updates via email"})]}),e.jsx("input",{type:"checkbox",id:"email_alerts",name:"email_alerts",checked:i.email_alerts,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded dark:border-gray-600"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"push_notifications",className:"font-medium text-gray-700 dark:text-gray-300",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Get alerts on your device"})]}),e.jsx("input",{type:"checkbox",id:"push_notifications",name:"push_notifications",checked:i.push_notifications,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded dark:border-gray-600"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sms_alerts",className:"font-medium text-gray-700 dark:text-gray-300",children:"SMS Alerts"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Get text message alerts"})]}),e.jsx("input",{type:"checkbox",id:"sms_alerts",name:"sms_alerts",checked:i.sms_alerts,onChange:g,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded dark:border-gray-600"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"disaster_radius_km",className:"font-medium text-gray-700 dark:text-gray-300",children:"Alert Radius (km)"}),e.jsx("input",{type:"range",id:"disaster_radius_km",name:"disaster_radius_km",min:"1",max:"100",value:i.disaster_radius_km,onChange:g,className:"mt-2 w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["Get alerts for disasters within ",i.disaster_radius_km,"km"]})]})]})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[o.theme==="dark"?e.jsx(R,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mr-2"}):e.jsx(D,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Appearance"})]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"theme",className:"block font-medium text-gray-700 dark:text-gray-300",children:"Theme"}),e.jsxs("select",{id:"theme",name:"theme",value:o.theme,onChange:b,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"system",children:"System"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"language",className:"block font-medium text-gray-700 dark:text-gray-300",children:"Language"}),e.jsxs("select",{id:"language",name:"language",value:o.language,onChange:b,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"hi",children:"Hindi"}),e.jsx("option",{value:"te",children:"Telugu"}),e.jsx("option",{value:"ta",children:"Tamil"}),e.jsx("option",{value:"kn",children:"Kannada"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timezone",className:"block font-medium text-gray-700 dark:text-gray-300",children:"Time Zone"}),e.jsxs("select",{id:"timezone",name:"timezone",value:o.timezone,onChange:b,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm",children:[e.jsx("option",{value:"Asia/Kolkata",children:"(GMT+5:30) India Standard Time"}),e.jsx("option",{value:"UTC",children:"UTC"})]})]})]})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-5 w-5 text-gray-400 dark:text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Privacy"})]})}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"share_location",className:"font-medium text-gray-700 dark:text-gray-300",children:"Share Location"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Allow app to access your location"})]}),e.jsx("input",{type:"checkbox",id:"share_location",name:"share_location",checked:m.share_location,onChange:p,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded dark:border-gray-600"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"public_profile",className:"font-medium text-gray-700 dark:text-gray-300",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Make your profile visible to others"})]}),e.jsx("input",{type:"checkbox",id:"public_profile",name:"public_profile",checked:m.public_profile,onChange:p,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded dark:border-gray-600"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"anonymous_reports",className:"font-medium text-gray-700 dark:text-gray-300",children:"Anonymous Reports"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Submit reports without showing your identity"})]}),e.jsx("input",{type:"checkbox",id:"anonymous_reports",name:"anonymous_reports",checked:m.anonymous_reports,onChange:p,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded dark:border-gray-600"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:E,disabled:j,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:j?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"animate-spin h-4 w-4 mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})})]})]})};export{B as default};
